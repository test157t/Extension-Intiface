<div id="intiface-connect-button" class="drawer">
  <div class="drawer-toggle drawer-header">
    <div class="drawer-icon fa-solid fa-heart-pulse fa-fw closedIcon" title="Intiface Connect"></div>
  </div>
  <div class="drawer-content closedDrawer">
<div class="flex-container alignitemscenter" style="gap: 10px;">
<h3 class="margin0 flex1">
<span>Intiface Connect</span>
<a href="https://intiface.com/" class="notes-link" target="_blank">
<span class="fa-solid fa-circle-question note-link-span"></span>
</a>
</h3>
</div>
<div id="intiface-status-panel" class="intiface-status disconnected">Status: Disconnected</div>
<div id="intiface-ai-status" style="margin-top: 8px; padding: 8px; background: rgba(0,0,0,0.05); border-radius: 4px;">
<div style="font-size: 0.8em; color: #888;">
<i class="fa-solid fa-robot"></i> <span id="intiface-ai-status-text">AI is ready to control your device via chat commands</span>
</div>
</div>
<div class="flex-container alignitemscenter" style="margin-top: 10px; gap: 8px;">
<input type="text" id="intiface-ip-input" class="text_pole" value="127.0.0.1:12345" placeholder="127.0.0.1:12345" style="flex: 1; min-width: 120px;">
<button id="intiface-connect-action-button" class="menu_button connect-button" style="white-space: nowrap;">
<i class="fa-solid fa-power-off"></i> <span class="btn-text">Connect</span>
</button>
<button id="intiface-rescan-button" class="menu_button" style="display: none;">
<i class="fa-solid fa-rotate"></i>
</button>
<label style="display: flex; align-items: center; cursor: pointer; font-size: 0.8em; white-space: nowrap;">
<input type="checkbox" id="intiface-auto-connect" style="margin-right: 4px;">
<span>Auto</span>
</label>
</div>
<div id="intiface-devices" style="margin-top: 10px;"></div>

<!-- Play Mode Section - Unified Pattern Control -->
<div style="margin-top: 15px;">
<div id="intiface-playmode-menu-toggle" class="menu_button" style="width: 100%; text-align: left; padding: 8px; background: rgba(100,100,255,0.15); border-radius: 4px; border: 1px solid rgba(100,100,255,0.3);">
<span style="display: flex; justify-content: space-between; align-items: center;">
<span><i class="fa-solid fa-gamepad"></i> Play Mode</span>
<span id="intiface-playmode-menu-arrow" style="transition: transform 0.3s;">▼</span>
</span>
</div>
<div id="intiface-playmode-menu-content" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 4px;">

<!-- Pattern Categories -->
<div style="margin-bottom: 15px;">
<div style="font-size: 0.85em; color: #aaa; margin-bottom: 10px;">
<i class="fa-solid fa-layer-group"></i> Pattern Categories
</div>

<!-- Category Tabs -->
<div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px;">
<button id="intiface-tab-basic" class="menu_button playmode-tab active" data-category="basic"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px; background: rgba(100,150,255,0.3);">
<i class="fa-solid fa-circle-play"></i> Basic
</button>
<button id="intiface-tab-denial" class="menu_button playmode-tab" data-category="denial"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-heart" style="color: #ff6464;"></i> Denial
</button>
<button id="intiface-tab-milking" class="menu_button playmode-tab" data-category="milking"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-cow" style="color: #64ff64;"></i> Milking
</button>
<button id="intiface-tab-training" class="menu_button playmode-tab" data-category="training"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-paw" style="color: #6464ff;"></i> Training
</button>
<button id="intiface-tab-robotic" class="menu_button playmode-tab" data-category="robotic"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-robot" style="color: #ff00ff;"></i> Robotic
</button>
<button id="intiface-tab-sissy" class="menu_button playmode-tab" data-category="sissy"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-gem" style="color: #ff64c8;"></i> Sissy
</button>
<button id="intiface-tab-prejac" class="menu_button playmode-tab" data-category="prejac"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-crown" style="color: #00ffff;"></i> Prejac
</button>
<button id="intiface-tab-evil" class="menu_button playmode-tab" data-category="evil"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-skull" style="color: #bf00ff;"></i> Evil
</button>
<button id="intiface-tab-frustration" class="menu_button playmode-tab" data-category="frustration"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-wand-magic-sparkles" style="color: #ffff00;"></i> Frustration
</button>
<button id="intiface-tab-hypno" class="menu_button playmode-tab" data-category="hypno"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-eye" style="color: #dda0dd;"></i> Hypno
</button>
<button id="intiface-tab-chastity" class="menu_button playmode-tab" data-category="chastity"
style="padding: 4px 10px; font-size: 0.75em; border-radius: 3px;">
<i class="fa-solid fa-heart" style="color: #ffc0cb;"></i> Chastity
</button>
</div>

<!-- Pattern Configuration Sliders -->
<div style="margin: 10px 0; padding: 8px; background: rgba(50,50,70,0.2); border-radius: 4px; border: 1px solid rgba(100,100,150,0.2);">
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
<label style="font-size: 0.75em; color: #64B5F6; white-space: nowrap; width: 70px;">
<i class="fa-solid fa-clock"></i> Duration:
</label>
<input type="range" id="intiface-pattern-duration" min="1000" max="1800000" value="5000" step="500" style="flex: 1;">
<span id="intiface-pattern-duration-display" style="font-size: 0.75em; color: #64B5F6; min-width: 50px;">5.0s</span>
</div>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
<label style="font-size: 0.75em; color: #64B5F6; white-space: nowrap; width: 70px;">
<i class="fa-solid fa-arrow-down"></i> Min:
</label>
<input type="range" id="intiface-pattern-min" min="0" max="100" value="20" style="flex: 1;">
<span id="intiface-pattern-min-display" style="font-size: 0.75em; color: #64B5F6; min-width: 35px;">20%</span>
</div>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
<label style="font-size: 0.75em; color: #64B5F6; white-space: nowrap; width: 70px;">
<i class="fa-solid fa-arrow-up"></i> Max:
</label>
<input type="range" id="intiface-pattern-max" min="0" max="100" value="80" style="flex: 1;">
<span id="intiface-pattern-max-display" style="font-size: 0.75em; color: #64B5F6; min-width: 35px;">80%</span>
</div>
<div style="display: flex; align-items: center; gap: 10px;">
<label style="font-size: 0.75em; color: #64B5F6; white-space: nowrap; width: 70px;">
<i class="fa-solid fa-rotate"></i> Cycles:
</label>
<input type="range" id="intiface-pattern-cycles" min="1" max="20" value="3" style="flex: 1;">
<span id="intiface-pattern-cycles-display" style="font-size: 0.75em; color: #64B5F6; min-width: 35px;">3</span>
</div>
<div style="font-size: 0.65em; color: #666; margin-top: 5px; padding-left: 80px;">
Adjust pattern parameters before placing on timeline
</div>
</div>

<!-- Pattern Buttons Container -->
<div id="intiface-pattern-buttons" style="display: flex; flex-wrap: wrap; gap: 5px; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px; min-height: 60px;">
<!-- Dynamically populated -->
<div style="color: #666; font-size: 0.8em; width: 100%; text-align: center; padding: 20px;">
Connect a device to see available patterns
</div>
</div>

<!-- Timeline Sequencer - Multi-track Pattern Editor -->
<div id="intiface-timeline-sequencer" style="margin-top: 15px; padding: 10px; background: rgba(30,30,50,0.3); border-radius: 4px; border: 1px solid rgba(100,100,150,0.3);">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
<div style="font-size: 0.85em; color: #dda0dd;">
<i class="fa-solid fa-sliders"></i> Timeline Sequencer
</div>
<div style="font-size: 0.7em; color: #888; display: flex; gap: 10px;">
<span>Click pattern → Click timeline to place</span>
<span style="color: #666;">|</span>
<span style="color: #ff6464;">Drag to move</span>
<span style="color: #666;">|</span>
<span style="color: #ff6464;">Right-click to delete</span>
</div>
</div>

<!-- Timeline Header - Time markers -->
<!-- Note: The scale and track lanes must align perfectly. Track header is 76px wide (60px + 8px padding each side) -->
<div id="intiface-timeline-header" style="display: flex; align-items: center; margin-bottom: 5px; padding-left: 76px;">
  <div id="intiface-timeline-scale" style="flex: 1; height: 20px; position: relative; background: rgba(0,0,0,0.2); border-radius: 2px;">
    <span id="timeline-scale-0" style="position: absolute; left: 0; font-size: 0.6em; color: #666;">0:00</span>
    <span id="timeline-scale-1" style="position: absolute; left: 25%; font-size: 0.6em; color: #666;">25%</span>
    <span id="timeline-scale-2" style="position: absolute; left: 50%; font-size: 0.6em; color: #666;">50%</span>
    <span id="timeline-scale-3" style="position: absolute; left: 75%; font-size: 0.6em; color: #666;">75%</span>
    <span id="timeline-scale-4" style="position: absolute; right: 0; font-size: 0.6em; color: #666;">100%</span>
  </div>
</div>

  <!-- Timeline Tracks -->
<div id="intiface-timeline-tracks" style="display: flex; flex-direction: column; gap: 4px; margin-bottom: 10px; padding-left: 76px;">
  <!-- Track A -->
  <div class="timeline-track-container" data-channel="A" style="display: flex; flex-direction: column; border-radius: 3px; border: 1px solid rgba(255,100,100,0.2); overflow: hidden;">
    <div class="timeline-track-header" style="display: flex; align-items: center; height: 24px; background: rgba(255,100,100,0.1); margin-left: -76px; padding-left: 76px;">
      <div style="width: 60px; padding: 0 8px; font-size: 0.7em; color: #ff6464; font-weight: bold; display: flex; align-items: center; gap: 5px;">
        <i class="fa-solid fa-wave-square"></i> A
      </div>
      <div style="flex: 1;"></div>
      <div style="display: flex; align-items: center; gap: 5px; padding: 0 8px; font-size: 0.65em;">
        <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; color: #888;">
          <input type="checkbox" id="channel-a-multi-motor" style="margin: 0;">
          <i class="fa-solid fa-fan" style="font-size: 0.8em;"></i>
        </label>
        <input type="number" id="channel-a-motor-count" min="1" max="8" value="2" style="width: 35px; font-size: 0.7em; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 2px; color: #fff; text-align: center; display: none;">
      </div>
    </div>
    <div class="timeline-track-lanes" data-channel="A" style="display: flex; flex-direction: column; flex: 1;">
      <div class="timeline-track-lane" style="height: 28px; position: relative; background: rgba(0,0,0,0.2); cursor: pointer; border-bottom: 1px solid rgba(255,100,100,0.1);" data-channel="A" data-motor="1"></div>
    </div>
  </div>
        <!-- Track B -->
        <div class="timeline-track-container" data-channel="B" style="display: flex; flex-direction: column; border-radius: 3px; border: 1px solid rgba(100,255,100,0.2); overflow: hidden;">
            <div class="timeline-track-header" style="display: flex; align-items: center; height: 24px; background: rgba(100,255,100,0.1);">
                <div style="width: 60px; padding: 0 8px; font-size: 0.7em; color: #64ff64; font-weight: bold; display: flex; align-items: center; gap: 5px;">
                    <i class="fa-solid fa-wave-square"></i> B
                </div>
                <div style="flex: 1;"></div>
                <div style="display: flex; align-items: center; gap: 5px; padding: 0 8px; font-size: 0.65em;">
                    <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; color: #888;">
                        <input type="checkbox" id="channel-b-multi-motor" style="margin: 0;">
                        <i class="fa-solid fa-fan" style="font-size: 0.8em;"></i>
                    </label>
                    <input type="number" id="channel-b-motor-count" min="1" max="8" value="2" style="width: 35px; font-size: 0.7em; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 2px; color: #fff; text-align: center; display: none;">
                </div>
            </div>
            <div class="timeline-track-lanes" data-channel="B" style="display: flex; flex-direction: column; flex: 1;">
                <div class="timeline-track-lane" style="height: 28px; position: relative; background: rgba(0,0,0,0.2); cursor: pointer; border-bottom: 1px solid rgba(100,255,100,0.1);" data-channel="B" data-motor="1"></div>
            </div>
        </div>
        <!-- Track C -->
        <div class="timeline-track-container" data-channel="C" style="display: flex; flex-direction: column; border-radius: 3px; border: 1px solid rgba(100,100,255,0.2); overflow: hidden;">
            <div class="timeline-track-header" style="display: flex; align-items: center; height: 24px; background: rgba(100,100,255,0.1);">
                <div style="width: 60px; padding: 0 8px; font-size: 0.7em; color: #6464ff; font-weight: bold; display: flex; align-items: center; gap: 5px;">
                    <i class="fa-solid fa-wave-square"></i> C
                </div>
                <div style="flex: 1;"></div>
                <div style="display: flex; align-items: center; gap: 5px; padding: 0 8px; font-size: 0.65em;">
                <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; color: #888;">
                    <input type="checkbox" id="channel-c-multi-motor" style="margin: 0;">
                    <i class="fa-solid fa-fan" style="font-size: 0.8em;"></i>
                </label>
                <input type="number" id="channel-c-motor-count" min="1" max="8" value="2" style="width: 35px; font-size: 0.7em; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 2px; color: #fff; text-align: center; display: none;">
            </div>
        </div>
        <!-- Track D -->
        <div class="timeline-track" data-channel="D" style="display: flex; align-items: center; height: 32px; background: rgba(255,0,255,0.1); border-radius: 3px; border: 1px solid rgba(255,0,255,0.2);">
            <div style="width: 60px; padding: 0 8px; font-size: 0.7em; color: #ff00ff; font-weight: bold; display: flex; align-items: center; gap: 5px;">
                <i class="fa-solid fa-wave-square"></i> D
            </div>
            <div class="timeline-track-lane" style="flex: 1; height: 100%; position: relative; background: rgba(0,0,0,0.2); cursor: pointer;" data-channel="D"></div>
            <div style="display: flex; align-items: center; gap: 5px; padding: 0 8px; font-size: 0.65em;">
                <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; color: #888;">
                    <input type="checkbox" id="channel-d-multi-motor" style="margin: 0;">
                    <i class="fa-solid fa-fan" style="font-size: 0.8em;"></i>
                </label>
                <input type="number" id="channel-d-motor-count" min="1" max="8" value="2" style="width: 35px; font-size: 0.7em; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 2px; color: #fff; text-align: center; display: none;">
            </div>
        </div>
    </div>

<!-- Timeline Controls -->
<div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 3px;">
<button id="intiface-timeline-play" class="menu_button" style="padding: 5px 15px; font-size: 0.8em; background: rgba(100,255,100,0.2);">
<i class="fa-solid fa-play"></i> Play
</button>
<button id="intiface-timeline-pause" class="menu_button" style="padding: 5px 15px; font-size: 0.8em; background: rgba(255,165,0,0.2);">
                <i class="fa-solid fa-pause"></i> Pause
            </button>
<div style="flex: 1; display: flex; align-items: center; gap: 5px;">
<div style="font-size: 0.7em; color: #888;">Time:</div>
<div id="intiface-timeline-current-time" style="font-size: 0.8em; color: #64B5F6; min-width: 50px;">0.0s</div>
<input type="range" id="intiface-timeline-scrubber" min="0" max="30000" value="0" style="flex: 1;" title="Scrub timeline">
            <div id="intiface-timeline-end-time" style="font-size: 0.7em; color: #888;">30s</div>
</div>
<button id="intiface-timeline-clear" class="menu_button" style="padding: 5px 10px; font-size: 0.75em;">
<i class="fa-solid fa-trash"></i>
</button>
</div>

<!-- Selected Pattern Indicator -->
<div id="intiface-timeline-selected" style="margin-top: 8px; padding: 8px; background: rgba(100,150,255,0.1); border-radius: 3px; font-size: 0.75em; color: #888; display: none;">
<i class="fa-solid fa-hand-pointer"></i> <span id="intiface-timeline-selected-text">Click a pattern above, then click on a timeline track to place it</span>
</div>
</div>
</div>

<!-- AI Mode Toggles -->
<div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
<div style="font-size: 0.85em; color: #aaa; margin-bottom: 10px;">
<i class="fa-solid fa-robot"></i> AI Play Modes
</div>
<div style="font-size: 0.75em; color: #888; margin-bottom: 8px;">
Enable which modes AI can use:
</div>

<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(255,100,100,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-denial" class="playmode-toggle" data-mode="denial" checked style="margin-right: 5px;">
<i class="fa-solid fa-heart" style="margin-right: 4px; color: #ff6464; font-size: 0.8em;"></i>
Denial
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(100,255,100,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-milking" class="playmode-toggle" data-mode="milking" checked style="margin-right: 5px;">
<i class="fa-solid fa-cow" style="margin-right: 4px; color: #64ff64; font-size: 0.8em;"></i>
Milking
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(100,100,255,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-training" class="playmode-toggle" data-mode="training" checked style="margin-right: 5px;">
<i class="fa-solid fa-paw" style="margin-right: 4px; color: #6464ff; font-size: 0.8em;"></i>
Training
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(255,0,255,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-robotic" class="playmode-toggle" data-mode="robotic" checked style="margin-right: 5px;">
<i class="fa-solid fa-robot" style="margin-right: 4px; color: #ff00ff; font-size: 0.8em;"></i>
Robotic
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(255,100,200,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-sissy" class="playmode-toggle" data-mode="sissy" checked style="margin-right: 5px;">
<i class="fa-solid fa-gem" style="margin-right: 4px; color: #ff64c8; font-size: 0.8em;"></i>
Sissy
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(0,255,255,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-prejac" class="playmode-toggle" data-mode="prejac" checked style="margin-right: 5px;">
<i class="fa-solid fa-crown" style="margin-right: 4px; color: #00ffff; font-size: 0.8em;"></i>
Prejac
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(128,0,128,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-evil" class="playmode-toggle" data-mode="evil" checked style="margin-right: 5px;">
<i class="fa-solid fa-skull" style="margin-right: 4px; color: #bf00ff; font-size: 0.8em;"></i>
Evil
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(255,255,0,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-frustration" class="playmode-toggle" data-mode="frustration" checked style="margin-right: 5px;">
<i class="fa-solid fa-wand-magic-sparkles" style="margin-right: 4px; color: #ffff00; font-size: 0.8em;"></i>
Frustration
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(138,43,226,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-hypno" class="playmode-toggle" data-mode="hypno" checked style="margin-right: 5px;">
<i class="fa-solid fa-eye" style="margin-right: 4px; color: #dda0dd; font-size: 0.8em;"></i>
Hypno
</label>
<label style="font-size: 0.75em; display: flex; align-items: center; cursor: pointer; background: rgba(255,192,203,0.1); padding: 3px 8px; border-radius: 3px;">
<input type="checkbox" id="intiface-mode-chastity" class="playmode-toggle" data-mode="chastity" checked style="margin-right: 5px;">
<i class="fa-solid fa-heart" style="margin-right: 4px; color: #ffc0cb; font-size: 0.8em;"></i>
Chastity
</label>
</div>
</div>
</div>

<div id="intiface-mode-menu-content" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 4px;">
<div style="font-size: 0.85em; color: #aaa; margin-bottom: 10px;">
Enable/disable AI mode categories
</div>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
<input type="checkbox" id="intiface-mode-denial-domina" style="margin-right: 8px;">
<i class="fa-solid fa-heart" style="margin-right: 5px; color: #ff6464;"></i>
Denial Domina Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
<input type="checkbox" id="intiface-mode-milk-maid" style="margin-right: 8px;">
<i class="fa-solid fa-cow" style="margin-right: 5px; color: #64ff64;"></i>
Milk Maid Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
<input type="checkbox" id="intiface-mode-pet-training" style="margin-right: 8px;">
<i class="fa-solid fa-paw" style="margin-right: 5px; color: #6464ff;"></i>
Pet Training Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
<input type="checkbox" id="intiface-mode-sissy-surrender" style="margin-right: 8px;">
<i class="fa-solid fa-gem" style="margin-right: 5px; color: #ff64c8;"></i>
Sissy Surrender Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
<input type="checkbox" id="intiface-mode-prejac-princess" style="margin-right: 8px;">
<i class="fa-solid fa-crown" style="margin-right: 5px; color: #00ffff;"></i>
Prejac Princess Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
<input type="checkbox" id="intiface-mode-robotic-ruination" style="margin-right: 8px;">
<i class="fa-solid fa-robot" style="margin-right: 5px; color: #ff00ff;"></i>
Robotic Ruination Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
<input type="checkbox" id="intiface-mode-evil-edging-mistress" style="margin-right: 8px;">
<i class="fa-solid fa-skull" style="margin-right: 5px; color: #bf00ff;"></i>
Evil Edging Mistress Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
<input type="checkbox" id="intiface-mode-frustration-fairy" style="margin-right: 8px;">
<i class="fa-solid fa-wand-magic-sparkles" style="margin-right: 5px; color: #ffff00;"></i>
Frustration Fairy Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
<input type="checkbox" id="intiface-mode-hypno-helper" style="margin-right: 8px;">
<i class="fa-solid fa-eye" style="margin-right: 5px; color: #dda0dd;"></i>
Hypno Helper Modes
</label>

<label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
<input type="checkbox" id="intiface-mode-chastity-caretaker" style="margin-right: 8px;">
<i class="fa-solid fa-heart" style="margin-right: 5px; color: #ffc0cb;"></i>
Chastity Caretaker Modes
</label>

<div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
<div style="font-size: 0.85em; color: #aaa; margin-bottom: 10px;">
<i class="fa-solid fa-sliders"></i> Mode Intensity Multipliers (50%-400%)
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Denial Domina</span>
<span id="intiface-mode-intensity-denial-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-denial" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Milk Maid</span>
<span id="intiface-mode-intensity-milk-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-milk" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Pet Training</span>
<span id="intiface-mode-intensity-pet-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-pet" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Sissy Surrender</span>
<span id="intiface-mode-intensity-sissy-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-sissy" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Prejac Princess</span>
<span id="intiface-mode-intensity-prejac-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-prejac" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Robotic Ruination</span>
<span id="intiface-mode-intensity-robotic-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-robotic" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Evil Edging Mistress</span>
<span id="intiface-mode-intensity-evil-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-evil" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Frustration Fairy</span>
<span id="intiface-mode-intensity-frustration-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-frustration" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Hypno Helper</span>
<span id="intiface-mode-intensity-hypno-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-hypno" min="50" max="400" value="100" style="width: 100%;">
</div>

<div style="margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Chastity Caretaker</span>
<span id="intiface-mode-intensity-chastity-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-mode-intensity-chastity" min="50" max="400" value="100" style="width: 100%;">
</div>

<button id="intiface-reset-mode-intensities" class="menu_button" style="width: 100%; margin-top: 10px; padding: 6px; font-size: 0.75em;">
<i class="fa-solid fa-rotate-left"></i> Reset All to 100%
</button>
</div>
</div>
</div>

<!-- Media Player Section in Menu -->
    <div style="margin-top: 15px;">
      <div id="intiface-media-menu-toggle" class="menu_button" style="width: 100%; text-align: left; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px;">
        <span style="display: flex; justify-content: space-between; align-items: center;">
          <span><i class="fa-solid fa-film"></i> Media Library</span>
          <span id="intiface-media-menu-arrow" style="transition: transform 0.3s;">▼</span>
        </span>
      </div>
      <div id="intiface-media-menu-content" style="display: none; margin-top: 10px;">
        <!-- Refresh Button -->
        <button id="intiface-menu-refresh-media-btn" class="menu_button" style="width: 100%; margin-bottom: 10px;">
          <i class="fa-solid fa-rotate"></i> Refresh Media List
        </button>
        
        <!-- Media List -->
        <div id="intiface-menu-media-list" style="max-height: 250px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 5px;">
          <div style="color: #888; font-size: 0.85em; text-align: center; padding: 20px;">
            Click refresh to load media files
          </div>
        </div>
        
      <!-- Help Text -->
      <div style="margin-top: 10px; padding: 8px; background: rgba(100,100,100,0.1); border-radius: 4px; font-size: 0.75em; color: #888;">
        <strong>Folders:</strong><br>
        Media: <code>data/default-user/assets/intiface_media/</code><br>
        Funscripts: <code>data/default-user/assets/funscript/</code><br>
        <em>Supports: MP4, WebM, MKV, AVI, MOV + MP3, WAV, OGG, FLAC, M4A<br>
        Funscripts must match media filenames</em>
      </div>
      </div>
    </div>

    <!-- Funscript Settings Section -->
    <div style="margin-top: 15px;">
      <div id="intiface-funscript-menu-toggle" class="menu_button" style="width: 100%; text-align: left; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px;">
        <span style="display: flex; justify-content: space-between; align-items: center;">
          <span><i class="fa-solid fa-chart-line"></i> Playback Settings</span>
          <span id="intiface-funscript-menu-arrow" style="transition: transform 0.3s;">▼</span>
        </span>
      </div>
<div id="intiface-funscript-menu-content" style="display: none; margin-top: 10px;">
<!-- Sync Settings -->
<div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.1); border-radius: 4px;">
<div style="font-size: 0.85em; font-weight: bold; margin-bottom: 10px;">
<i class="fa-solid fa-sliders"></i> Sync Settings
</div>

          <div style="margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 5px;">
              <span>Sync Offset</span>
              <span id="intiface-menu-sync-display" style="color: #64B5F6;">0ms</span>
            </div>
            <input type="range" id="intiface-menu-sync-offset" min="-5000" max="5000" value="0" style="width: 100%;">
            <div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
              <span>-5s</span>
              <span>+5s</span>
            </div>
          </div>

          <div>
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 5px;">
  <span>Intensity (0-400%)</span>
  <span id="intiface-menu-intensity-display" style="color: #4CAF50;">100%</span>
</div>
<input type="range" id="intiface-menu-intensity" min="0" max="400" value="100" style="width: 100%;">
<div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
  <span>0%</span>
  <span>400%</span>
</div>
          </div>

      <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
        <label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer;">
          <input type="checkbox" id="intiface-menu-loop" style="margin-right: 8px;">
          <i class="fa-solid fa-repeat" style="margin-right: 5px; color: #888;"></i>
          Loop video
        </label>
      </div>

      <!-- Global Intensity -->
      <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
        <div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 5px;">
          <span><i class="fa-solid fa-sliders"></i> Global Intensity</span>
          <span id="intiface-global-intensity-display" style="color: #64B5F6;">100%</span>
        </div>
        <input type="range" id="intiface-global-intensity" min="10" max="400" value="100" style="width: 100%;">
        <div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
          <span>10%</span>
          <span>400%</span>
        </div>
    </div>

    <!-- Device Polling Rate -->
    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
      <div style="font-size: 0.85em; font-weight: bold; margin-bottom: 10px;">
        <i class="fa-solid fa-tachometer-alt"></i> Device Polling Rate
      </div>
      <div style="margin-bottom: 10px;">
        <div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
          <span>Polling Rate (Hz)</span>
          <span id="intiface-polling-rate-display" style="color: #64B5F6;">30Hz</span>
        </div>
        <input type="range" id="intiface-polling-rate" min="10" max="60" value="30" step="1" style="width: 100%;">
        <div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
          <span>10Hz</span>
          <span>60Hz</span>
        </div>
      </div>
      <div style="font-size: 0.7em; color: #888; margin-top: 5px; font-style: italic;">
        Lower = less device spam, better battery. Higher = smoother playback, more responsive.
        <br><strong>10-20Hz:</strong> Power saving | <strong>30Hz:</strong> Balanced (default) | <strong>60Hz:</strong> Maximum smoothness
      </div>
    </div>

    <!-- Output Inversion -->
    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
      <div style="font-size: 0.85em; font-weight: bold; margin-bottom: 10px;">
        <i class="fa-solid fa-rotate"></i> Output Inversion
      </div>
      <label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
        <input type="checkbox" id="intiface-global-invert" style="margin-right: 8px;">
        <span style="color: #bbb;">Invert All Device Output (0% ↔ 100%)</span>
      </label>
      <div id="intiface-global-invert-status" style="font-size: 0.7em; color: #888; margin-top: 5px; display: none;">
        <i class="fa-solid fa-rotate" style="color: #64B5F6;"></i> Inversion active - funscripts, patterns & commands reversed
      </div>
      <div style="font-size: 0.7em; color: #888; margin-top: 5px; font-style: italic;">
        Reverses all intensity values for all devices. Useful if your device responds backwards to commands.
      </div>
</div>
</div>

<!-- Player Appearance Settings -->
<div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
<div style="font-size: 0.85em; font-weight: bold; margin-bottom: 10px;">
<i class="fa-solid fa-palette"></i> Player Appearance
</div>

<div style="margin-bottom: 12px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Video Opacity</span>
<span id="intiface-menu-video-opacity-display" style="color: #64B5F6;">100%</span>
</div>
<input type="range" id="intiface-menu-video-opacity" min="20" max="100" value="100" style="width: 100%;">
<div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
<span>20%</span>
<span>100%</span>
</div>
</div>

<div style="margin-bottom: 12px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Player Scale</span>
<span id="intiface-menu-width-display" style="color: #64B5F6;">1.0x</span>
</div>
<input type="range" id="intiface-menu-width" min="20" max="100" value="100" style="width: 100%;">
<div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
<span>0.2x</span>
<span>1.0x</span>
</div>
</div>

<div style="margin-bottom: 10px;">
<div style="font-size: 0.75em; margin-bottom: 5px;">Player Position</div>
<select id="intiface-menu-position" style="width: 100%; padding: 4px; font-size: 0.8em; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 3px; color: inherit;">
<option value="top">Top of chat</option>
<option value="center">Center screen</option>
</select>
</div>

<div style="margin-bottom: 12px;">
<div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 3px;">
<span>Z-Index (stacking order)</span>
<span id="intiface-menu-zindex-display" style="color: #64B5F6;">1</span>
</div>
<input type="range" id="intiface-menu-zindex" min="1" max="100" value="1" style="width: 100%;">
<div style="display: flex; justify-content: space-between; font-size: 0.65em; color: #666; margin-top: 2px;">
<span>1</span>
<span>100</span>
</div>
<div style="font-size: 0.65em; color: #888; margin-top: 3px; font-style: italic;">
Higher values appear above other elements
</div>
</div>

<div>
<button id="intiface-reset-appearance-btn" class="menu_button" style="width: 100%; font-size: 0.75em; padding: 5px;">
<i class="fa-solid fa-rotate-left"></i> Reset to defaults
</button>
</div>
</div>
</div>
</div>

<!-- Advanced Configuration (Collapsed by default) -->
    <div style="margin-top: 15px;">
      <div id="intiface-advanced-toggle" class="menu_button" style="width: 100%; text-align: left; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px;">
        <span style="display: flex; justify-content: space-between; align-items: center;">
          <span>Advanced Configuration</span>
          <span id="intiface-advanced-arrow" style="transition: transform 0.3s;">▼</span>
        </span>
      </div>
      <div id="intiface-advanced-content" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 4px;">
        <div style="font-size: 0.85em; color: #aaa; margin-bottom: 8px;">
          Path to IntifaceCentral.exe (allows AI to auto-start)
        </div>
        <div class="flex-container alignitemscenter" style="gap: 8px;">
          <input type="text" id="intiface-exe-path" class="text_pole" placeholder="C:\Program Files\Intiface\IntifaceCentral.exe" style="flex-grow: 1;">
        </div>
        <div id="intiface-exe-status" style="margin-top: 5px; font-size: 0.75em; color: #888;">Not configured</div>
                <div style="margin-top: 5px; font-size: 0.7em; color: #666; font-style: italic;">
                    Type the full path to IntifaceCentral.exe
                </div>

                <!-- WebSocket Proxy Settings -->
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                    <div style="font-size: 0.85em; font-weight: bold; margin-bottom: 10px;">
                        <i class="fa-solid fa-network-wired"></i> WebSocket Proxy
                    </div>
                    <label style="font-size: 0.8em; display: flex; align-items: center; cursor: pointer; margin-bottom: 8px;">
                        <input type="checkbox" id="intiface-use-internal-proxy" style="margin-right: 8px;">
                        <i class="fa-solid fa-server" style="margin-right: 5px; color: #64B5F6;"></i>
                        Use Internal Proxy (for HTTPS access)
                    </label>
                    <div style="font-size: 0.7em; color: #888; margin-top: 5px; font-style: italic;">
                        Forwards local Intiface connection through secure WebSocket proxy. Required when accessing SillyTavern via HTTPS.
                    </div>
<div id="intiface-proxy-status" style="font-size: 0.75em; color: #888; margin-top: 8px; display: none;">
        <i class="fa-solid fa-circle" style="color: #4CAF50; font-size: 0.6em; margin-right: 5px;"></i>
Proxy running on port 12346
</div>
</div>

</div>
</div>
